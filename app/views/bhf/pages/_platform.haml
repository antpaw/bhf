- @platform.pagination.template = self
%table{:id => "#{@platform.name}_platform", :class => (@platform.custom_columns? ? 'custom_columns' : 'default_columns')}
  %caption
    %h4= @platform.title
    %p.info= @platform.pagination.info @platform
    
    = render :partial => 'search', :locals => {:platform => @platform} if @platform.search?

    %p.create= link_to new_t(@platform), new_bhf_entry_path(@platform.name), :class => 'alt_button'

  %thead
    %tr
      - if @platform.sortable
        %th.drag
      - @platform.columns.each do |column|
        %th{:class => "#{column.field.macro} #{column.field.display_type} #{order_class(column.name, @platform.name)}"}
          - column_name = @platform.model.human_attribute_name(column.name)
          - link = link_to column_name, current_order_path(column.name, @platform.name)
          = column.field.macro == :column ? link : column_name

      %th.action

  %tfoot
    %tr
      %td{:colspan => @platform.columns_count}
        = @platform.pagination.create(@platform) unless @platform.sortable

  %tbody{:class => ('sortable' if @platform.sortable), :'data-sort-url' => sort_bhf_entries_path(@platform.name)}
    - if @platform.objects.any?
      - @platform.objects.each do |object|
        - edit_link = edit_bhf_entry_path(@platform.name, object)
        %tr{:id => "#{object.id}_#{@platform.name}"}
          - if @platform.sortable
            %td
              %span.handle &nbsp;
          - @platform.columns.each do |column|
            %td{:class => "#{column.field.macro} #{column.field.display_type}", :'data-column-name' => column.name}
              - a = if column.field.display_type != :boolean && object.send(column.name).blank?
                - '&nbsp;'
              - else
                - render(:partial => "bhf/pages/macro/#{column.field.macro}/#{column.field.display_type}", :locals => {:column => column, :object => object})
              
              = has_link?(column.field.overwrite_display_type) ? a.html_safe : link_to(a.html_safe, edit_link, :class => 'quick_edit')
          %td.action
            = link_to edit_t(@platform), edit_link, :class => 'edit'
            = link_to delete_t(@platform), bhf_entry_path(@platform.name, object), :method => :delete, :confirm => t('bhf.helpers.promts.confirm'), :class => 'delete'
            -# TODO: :remote => true, authlogic problem?
    - else
      %td.no_entries{:colspan => @platform.columns_count}
        = t 'bhf.pagination.info.nothing_found', :name => t('bhf.pagination.entries')
        = link_to new_t(@platform), new_bhf_entry_path(@platform.name)